---
title: "The Grammar of Graphics"
subtitle: "R for Artists and Designers"
author: "Arvind Venkatadri"
date: 22/April/2021
output:
  html_document:
    toc_float: true
    theme: yeti
    toc: true
    code_download: true
abstract: Part of the `R for Artists and Designers` at the School of Foundation Studies, Srishti Manipal Institute of Art, Design, and Technology, Bangalore.
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This RMarkdown document is part of the Generic Skills Component (GSK) of the <strong>Play and Invent - Applied Metaphorics</strong> Course of the Foundation Studies Programme at Srishti Manipal Institute of Art, Design, and Technology, Bangalore India. The material is based on <em>A Layered Grammar of Graphics</em> by Hadley Wickham. The course is meant for First Year students pursuing a Degree in Art and Design.</p>
<p>The intent of this GSK part is to build Skill in coding in R, and also appreciate R as a way to metaphorically visualize information of various kinds, using predominantly geometric figures and structures.</p>
<p>All RMarkdown files combine code, text, web-images, and figures developed using code. Everything is text; code chunks are enclosed in <strong>fences</strong> (```)</p>
<div id="set-up" class="section level2">
<h2>Set Up</h2>
<p>The <code>setup</code> code <strong>chunk</strong> below brings into our coding session <strong>R packages</strong> that provide specific computational abilities and also <strong>datasets</strong> which we can use.</p>
<p>Packages and datasets are <strong>not</strong> the same thing !! Packages are (small) collections of programs. Datasets are just….information.</p>
</div>
</div>
<div id="a-teaser-from-john-snow" class="section level1">
<h1>A Teaser from John Snow</h1>
<pre class="r"><code>SnowMap(polygons = TRUE)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/teaser-1.png" width="672" /></p>
<pre class="r"><code># Write some comments on this code and what it seems to be creating
# Are there &quot;layers&quot; in this visualization?







#</code></pre>
</div>
<div id="tidy-data" class="section level1">
<h1>Tidy Data</h1>
<p>“Tidy Data” is an important way of thinking about what data typically look like in R. Let’s fetch a figure from the web to show the (preferred) structure of data in R. (The syntax to bring in a web-figure is <code>![caption](url)</code>)</p>
<p><img src="https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/tidydata_1.jpg" alt="Tidy Data" />
The three features described in the figure above define the nature of tidy data:</p>
<ul>
<li><em>Variables in Columns</em><br />
</li>
<li><em>Observations in Rows</em> and<br />
</li>
<li><em>Measurements in Cells</em>.</li>
</ul>
<p>Data are imagined to be resulting from an <strong>experiment</strong>. Each <em>variable</em> represents a parameter/aspect in the experiment. Each <em>row</em> represents an additional datum of measurement. A <em>cell</em> is a single measurement on a single parameter(column) in a single observation(row).</p>
<div id="kinds-of-variables" class="section level2">
<h2>Kinds of Variables</h2>
<p><strong>Kinds of Variable</strong> are defined by the kind of <em>questions</em> they answer to:</p>
<ol style="list-style-type: decimal">
<li>What/Who/Where? -&gt; Some kind of Name. <strong>Categorical</strong> variable</li>
<li>What Kind? How? -&gt; Some kind of “Type”. <strong>Factor</strong> variable</li>
<li>How Many? How large? -&gt; Some kind of Quantity. <strong>Numerical</strong> variable.
Most Figures in R are computed with variables, and therefore, with <strong>columns</strong>.</li>
</ol>
</div>
</div>
<div id="interrogations-and-graphs" class="section level1">
<h1>Interrogations and Graphs</h1>
<p>Creating graphs from data is an act of asking questions and viewing answers in a geometric way.
Let us write some simple English descriptions of measures and visuals and see what commands they use in R.</p>
</div>
<div id="components-of-the-layered-grammar-of-graphics" class="section level1">
<h1>Components of the layered grammar of graphics</h1>
<p><strong>Layers</strong> are used to create the objects on a plot. They are defined by five basic parts:</p>
<ol style="list-style-type: decimal">
<li>Data (What dataset/spreadsheet am I using?)</li>
<li>Mapping (What does each column do in my graph?)</li>
<li>Statistical transformation (stat) (Do I have count something first?)</li>
<li>Geometric object (geom) (What shape, colour, size…do I want?)</li>
<li>Position adjustment (position) (Where do I want it on the graph?)</li>
</ol>
<div id="data" class="section level2 tabset tabset-pills">
<h2>Data</h2>
<p>We will use “real world” data. Let’s use the <code>penguins</code> dataset in the <code>palmerpenguins</code> package. Run <code>?penguins</code> in the console to get more information about this dataset.</p>
<div id="head" class="section level3">
<h3>Head</h3>
<pre class="r"><code>head(penguins)</code></pre>
<pre><code>## # A tibble: 6 x 8
##   species island bill_length_mm bill_depth_mm flipper_length_~ body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Adelie  Torge~           39.1          18.7              181        3750 male 
## 2 Adelie  Torge~           39.5          17.4              186        3800 fema~
## 3 Adelie  Torge~           40.3          18                195        3250 fema~
## 4 Adelie  Torge~           NA            NA                 NA          NA &lt;NA&gt; 
## 5 Adelie  Torge~           36.7          19.3              193        3450 fema~
## 6 Adelie  Torge~           39.3          20.6              190        3650 male 
## # ... with 1 more variable: year &lt;int&gt;</code></pre>
</div>
<div id="tail" class="section level3">
<h3>Tail</h3>
<pre class="r"><code>tail(penguins)</code></pre>
<pre><code>## # A tibble: 6 x 8
##   species island bill_length_mm bill_depth_mm flipper_length_~ body_mass_g sex  
##   &lt;fct&gt;   &lt;fct&gt;           &lt;dbl&gt;         &lt;dbl&gt;            &lt;int&gt;       &lt;int&gt; &lt;fct&gt;
## 1 Chinst~ Dream            45.7          17                195        3650 fema~
## 2 Chinst~ Dream            55.8          19.8              207        4000 male 
## 3 Chinst~ Dream            43.5          18.1              202        3400 fema~
## 4 Chinst~ Dream            49.6          18.2              193        3775 male 
## 5 Chinst~ Dream            50.8          19                210        4100 male 
## 6 Chinst~ Dream            50.2          18.7              198        3775 fema~
## # ... with 1 more variable: year &lt;int&gt;</code></pre>
</div>
<div id="dim" class="section level3">
<h3>Dim</h3>
<pre class="r"><code>dim(penguins)</code></pre>
<pre><code>## [1] 344   8</code></pre>
<p>So we know what our data looks like. We pass this data to <code>ggplot</code> use to plot as follows: in R this creates an empty graph sheet!! Because we have not (yet) declared the geometric shapes we want to use to plot our information.</p>
<pre class="r"><code>ggplot(data = penguins) # Creates an empty graphsheet, ready for plotting!!</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/data-1-1.png" width="672" /></p>
</div>
</div>
<div id="mapping" class="section level2">
<h2>Mapping</h2>
<p>Now that we have told R what data to use, we need to state what variables to plot and how.</p>
<p><strong>Aesthetic Mapping</strong> defines how the variables are applied to the plot, i.e. we take a variable from the data and “metaphorize” it into a geometric feature. We can map variables metaphorically to a variety of geometric things: coordinate, length, height, size, shape, colour, alpha(how dark?)….</p>
<p>The syntax uses: <code>aes(some_geometric_thing = some_variable)</code></p>
<p>Remember <strong>variable</strong> = <strong>column</strong>.</p>
<p>So if we were graphing information from <code>penguins</code>, we might map a penguin’s <code>flipper_length_mm</code> <strong>column</strong> to the <span class="math inline">\(x\)</span> position, and the <code>body_mass_g</code> <strong>column</strong> to the <span class="math inline">\(y\)</span> position.</p>
<div id="mapping-example-1" class="section level3 tabset tabset-pills">
<h3>Mapping Example-1</h3>
<p>We can try another example of aesthetic mapping with the same dataset:</p>
<div id="plot-1a" class="section level4">
<h4>Plot-1a</h4>
<pre class="r"><code>ggplot(data = penguins)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/mapping-1a-1.png" width="672" /></p>
</div>
<div id="plot-1b" class="section level4">
<h4>Plot-1b</h4>
<pre class='prettyprint'><code>ggplot(penguins) + <br><br># Plot geom = histogram. So we need a quantity on the x<br><span style='background-color:#ffff7f'> &nbsp;geom_histogram(</span><br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;aes(x = body_mass_g))</span></code></pre>
<pre><code>
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
<pre><code>
## Warning: Removed 2 rows containing non-finite values (stat_bin).
</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="plot-1c" class="section level4">
<h4>Plot-1c</h4>
<pre class='prettyprint'><code>ggplot(penguins) +<br><br># Plot geom = histogram. So we need a quantity on the x<br> &nbsp;geom_histogram(<br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;aes(x = body_mass_g,</span><br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fill = island) &nbsp;&nbsp;&nbsp;# color aesthetic = another variable</span><br> &nbsp;&nbsp;&nbsp;)</code></pre>
<pre><code>
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
<pre><code>
## Warning: Removed 2 rows containing non-finite values (stat_bin).
</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
</div>
</div>
<div id="mapping-example-2" class="section level3 tabset tabset-pills">
<h3>Mapping Example-2</h3>
<p>We can try another example of aesthetic mapping with the same dataset:</p>
<div id="plot-2a" class="section level4">
<h4>Plot-2a</h4>
<pre class="r"><code>ggplot(data = penguins)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/mapping-2a-1.png" width="672" /></p>
</div>
<div id="plot-2b" class="section level4">
<h4>Plot-2b</h4>
<pre class='prettyprint'><code>ggplot(penguins) + <br><br># Plot geom = histogram. So we need a quantity on the x<br><span style='background-color:#ffff7f'> &nbsp;geom_histogram(</span><br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;aes(x = body_mass_g))</span></code></pre>
<pre><code>
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
<pre><code>
## Warning: Removed 2 rows containing non-finite values (stat_bin).
</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="plot-2c" class="section level4">
<h4>Plot-2c</h4>
<pre class='prettyprint'><code>ggplot(penguins) +<br><br># Plot geom = histogram. So we need a quantity on the x<br> &nbsp;geom_histogram(<br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;aes(x = body_mass_g,</span><br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fill = island) &nbsp;&nbsp;&nbsp;# color aesthetic = another variable</span><br> &nbsp;&nbsp;&nbsp;)</code></pre>
<pre><code>
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
<pre><code>
## Warning: Removed 2 rows containing non-finite values (stat_bin).
</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
</div>
<div id="mapping-example-3" class="section level3 tabset tabset-pills">
<h3>Mapping Example-3</h3>
<p>We can try another example of aesthetic mapping with the same dataset:</p>
<div id="plot-3a" class="section level4">
<h4>Plot-3a</h4>
<pre class="r"><code>ggplot(data = penguins)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/mapping-3a-1.png" width="672" /></p>
</div>
<div id="plot-3b" class="section level4">
<h4>Plot-3b</h4>
<pre class='prettyprint'><code>ggplot(penguins) + <br><br># Plot geom = histogram. So we need a quantity on the x<br><span style='background-color:#ffff7f'> &nbsp;geom_histogram(</span><br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;aes(x = body_mass_g))</span></code></pre>
<pre><code>
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
<pre><code>
## Warning: Removed 2 rows containing non-finite values (stat_bin).
</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
</div>
<div id="plot-3c" class="section level4">
<h4>Plot-3c</h4>
<pre class='prettyprint'><code>ggplot(penguins) +<br><br># Plot geom = histogram. So we need a quantity on the x<br> &nbsp;geom_histogram(<br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;aes(x = body_mass_g,</span><br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fill = island) &nbsp;&nbsp;&nbsp;# color aesthetic = another variable</span><br> &nbsp;&nbsp;&nbsp;)</code></pre>
<pre><code>
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
<pre><code>
## Warning: Removed 2 rows containing non-finite values (stat_bin).
</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
</div>
<div id="mapping-example-4" class="section level3 tabset tabset-pills">
<h3>Mapping Example-4</h3>
<p>We can try another example of aesthetic mapping with the same dataset:</p>
<div id="plot-4a" class="section level4">
<h4>Plot-4a</h4>
<pre class="r"><code>ggplot(data = penguins)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/mapping-4a-1.png" width="672" /></p>
</div>
<div id="plot-4b" class="section level4">
<h4>Plot-4b</h4>
<pre class='prettyprint'><code>ggplot(penguins) + <br><br># Plot geom = histogram. So we need a quantity on the x<br><span style='background-color:#ffff7f'> &nbsp;geom_histogram(</span><br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;aes(x = body_mass_g))</span></code></pre>
<pre><code>
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
<pre><code>
## Warning: Removed 2 rows containing non-finite values (stat_bin).
</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="plot-4c" class="section level4">
<h4>Plot-4c</h4>
<pre class='prettyprint'><code>ggplot(penguins) +<br><br># Plot geom = histogram. So we need a quantity on the x<br> &nbsp;geom_histogram(<br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;aes(x = body_mass_g,</span><br><span style='background-color:#ffff7f'> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fill = island) &nbsp;&nbsp;&nbsp;# color aesthetic = another variable</span><br> &nbsp;&nbsp;&nbsp;)</code></pre>
<pre><code>
## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
</code></pre>
<pre><code>
## Warning: Removed 2 rows containing non-finite values (stat_bin).
</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
</div>
</div>
</div>
<div id="geometric-objects" class="section level2 tabset tabset-pills">
<h2>Geometric objects</h2>
<p><strong>Geometric objects</strong> (<em>geoms</em>) control the type of plot you create. Geoms are classified by their dimensionality:</p>
<ul>
<li>0 dimensions - point, text</li>
<li>1 dimension - path, line</li>
<li>2 dimensions - polygon, interval</li>
</ul>
<p>Each geom can only display certain <strong>aesthetics</strong> or visual attributes of the geom. For example, a point geom has position, color, shape, and size aesthetics.</p>
<p>We can also stack up geoms on top of one another to add layers to the graph.</p>
<div id="plot1" class="section level3">
<h3>Plot1</h3>
<pre class="r"><code>ggplot(penguins, aes(x = flipper_length_mm, y = body_mass_g)) +
  geom_line()</code></pre>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/other_geoms-1-1.png" width="672" /></p>
</div>
<div id="plot2" class="section level3">
<h3>Plot2</h3>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_line(aes(x = bill_length_mm, 
                     y = body_mass_g))</code></pre>
<pre><code>## Warning: Removed 2 row(s) containing missing values (geom_path).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/other-geoms-2-1.png" width="672" /></p>
</div>
<div id="plot3" class="section level3">
<h3>Plot3</h3>
<pre class="r"><code>ggplot(data = penguins) + 
  geom_point(aes(x = bill_length_mm, 
                     y = body_mass_g,
                 color = island, 
                 shape = species)) + 
  
  ggtitle(&quot;A point geom with position and color and shape aesthetics&quot;)</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/other-geoms-3-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = penguins, 
       aes(x = species)) + # x position =&gt; ?
  # No need to type &quot;mapping&quot;...
  geom_bar() + # Where does the height come from?
  ggtitle(&quot;A bar geom with position and height aesthetics&quot;)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/geom_bar-1-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = penguins, aes(x = species)) +
  geom_bar() +
  ggtitle(&quot;A bar geom with position and height aesthetics&quot;)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/geom_bar-2-1.png" width="672" /></p>
<ul>
<li>Position determines the starting location (origin) of each bar</li>
<li>Height determines how tall to draw the bar. Here the height is based on the number of observations in the dataset for each possible number of cylinders.</li>
</ul>
</div>
</div>
<div id="position-adjustment" class="section level2 tabset tabset-pills">
<h2>Position adjustment</h2>
<p>Sometimes with dense data we need to adjust the position of elements on the plot, otherwise data points might obscure one another. Bar plots frequently <strong>stack</strong> or <strong>dodge</strong> the bars to avoid overlap:</p>
<pre class="r"><code>count(x = penguins, species, island) %&gt;%
  ggplot(mapping = aes(x = species, y = n, fill = island)) +
  geom_bar(stat = &quot;identity&quot;) +
  ggtitle(label = &quot;A stacked bar chart&quot;)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/geom_bar_position_stack_and_dodge-1.png" width="672" /></p>
<pre class="r"><code>count(x = penguins, species, island) %&gt;%
  ggplot(mapping = aes(x = species, y = n, fill = island)) +
  geom_bar(stat = &quot;identity&quot;, position = &quot;dodge&quot;) +
  ggtitle(label = &quot;A dodged bar chart&quot;)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/geom_bar_position_stack_and_dodge-2.png" width="672" /></p>
<pre class="r"><code>penguins %&gt;%
  ggplot(mapping = aes(x = species, fill = island)) +
  geom_bar() +
  ggtitle(label = &quot;A stacked bar chart&quot;)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<pre class="r"><code>penguins %&gt;%
  ggplot(mapping = aes(x = species, fill = island)) +
  geom_bar(position = &quot;dodge&quot;) +
  ggtitle(label = &quot;A dodged bar chart&quot;)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/unnamed-chunk-9-2.png" width="672" /></p>
<p>Sometimes scatterplots with few unique <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> values are <strong>jittered</strong> (random noise is added) to reduce overplotting.</p>
<pre class="r"><code>ggplot(data = penguins, 
       mapping = aes(x = species, 
                     y = body_mass_g)) +
  geom_point() +
  ggtitle(&quot;A point geom with obscured data points&quot;)</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/position-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = penguins, 
       mapping = aes(x = species, 
                     y = body_mass_g)) +
  geom_jitter() +
  ggtitle(&quot;A point geom with jittered data points&quot;)</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/position-2.png" width="672" /></p>
</div>
<div id="statistical-transformation" class="section level2 tabset tabset-pills">
<h2>Statistical transformation</h2>
<p>A <strong>statistical transformation</strong> (<em>stat</em>) pre-transforms the data, before plotting. For instance, in a bar graph you might summarize the data by <code>count</code>ing the total number of observations within a set of categories, and then plotting the count.</p>
<div id="count" class="section level3">
<h3>Count</h3>
<pre class="r"><code>count(x = penguins, island)</code></pre>
<pre><code>## # A tibble: 3 x 2
##   island        n
##   &lt;fct&gt;     &lt;int&gt;
## 1 Biscoe      168
## 2 Dream       124
## 3 Torgersen    52</code></pre>
</div>
<div id="count-and-bar-graph" class="section level3">
<h3>Count and Bar Graph</h3>
<pre class="r"><code>mydat &lt;- count(penguins,island)

ggplot(data = mydat) +
    geom_col(aes(x = island, y = n))</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/stat-transform-2-1.png" width="672" /></p>
</div>
<div id="tidy-count-and-bar-graph" class="section level3">
<h3>Tidy Count and Bar Graph</h3>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/stat-transform-3-1.png" width="672" /></p>
<pre class='prettyprint'><code>penguins <span style='background-color:#ffff7f'>%>%</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# This IS a pipe Operator!!<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;count(<span style='background-color:#ffff7f'>.</span>, island) <span style='background-color:#ffff7f'>%>%</span> # "<span style='background-color:#ffff7f'>.</span>" represents what is passed from the preceding command<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;ggplot(<span style='background-color:#ffff7f'>.</span>) + &nbsp;&nbsp;&nbsp;<br>&nbsp;&nbsp;<br>&nbsp;&nbsp;geom_col(aes(x = island, y = n))</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
</div>
<div id="count-inside-the-plot" class="section level3">
<h3>Count inside the Plot</h3>
<pre class="r"><code>penguins %&gt;%           # Our pipe Operator
  
  ggplot(.) +          # &quot;.&quot; becomes the penguins dataset
  
  geom_bar(aes(x = island)) # Note: y = count, and is computed internally!!</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/stat-transform-4-1.png" width="672" /></p>
<p>Sometimes you don’t need to make a statistical transformation. For example, in a scatterplot you use the raw values for the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> variables to map onto the graph. In these situations, the statistical transformation is an <em>identity</em> transformation - the stat simply passes in the original dataset and exports the exact same dataset.</p>
</div>
</div>
<div id="scale" class="section level2 tabset tabset-pills">
<h2>Scale</h2>
<p>A <strong>scale</strong> controls how data is mapped to aesthetic attributes, so we need one scale for every aesthetic property employed in a layer. For example, this graph defines a scale for color:</p>
<pre class="r"><code>ggplot(data = penguins, 
       mapping = aes(x = bill_depth_mm, 
                     y = bill_length_mm, 
                     color = species)) +
  geom_point() </code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/scale-color-1.png" width="672" />
The scale can be changed to use a different color palette:</p>
<pre class="r"><code>ggplot(data = penguins, 
       mapping = aes(x = bill_length_mm, 
                     y = body_mass_g, 
                     color = species)) +
  geom_point() +
  scale_color_brewer(palette = &quot;Dark2&quot;,direction = -1)</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/scale-color-palette-1.png" width="672" /></p>
<p>Now we are using a different palette, but the scale is still consistent: all Adelie penguins utilize the same color, whereas Chinstrap use a new color <strong>but each Adelie still uses the same, consistent color</strong>.</p>
</div>
<div id="coordinate-system" class="section level2 tabset tabset-pills">
<h2>Coordinate system</h2>
<p>A <strong>coordinate system</strong> (<em>coord</em>) maps the position of objects onto the plane of the plot, and controls how the axes and grid lines are drawn. Plots typically use two coordinates (<span class="math inline">\(x, y\)</span>), but could use any number of coordinates. Most plots are drawn using the <a href="https://en.wikipedia.org/wiki/Cartesian_coordinate_system"><strong>Cartesian coordinate system</strong></a>:</p>
<pre class="r"><code>x1 &lt;- c(1, 10)
y1 &lt;- c(1, 5)
p &lt;- qplot(x = x1, y = y1, geom = &quot;point&quot;, xlab = NULL, ylab = NULL) +
  theme_bw()
p +
  ggtitle(label = &quot;Cartesian coordinate system&quot;)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/coord-cart-1.png" width="672" /></p>
<pre class="r"><code>ggplot(penguins, aes(flipper_length_mm, body_mass_g)) +
  geom_point() + 
  coord_polar()</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/coord-cart-2.png" width="672" /></p>
<p>This system requires a fixed and equal spacing between values on the axes.
That is, the graph draws the same distance between 1 and 2 as it does between 5 and 6. The graph could be drawn using a <a href="https://en.wikipedia.org/wiki/Semi-log_plot"><strong>semi-log coordinate system</strong></a> which logarithmically compresses the distance on an axis:</p>
<pre class="r"><code>p +
  coord_trans(y = &quot;log10&quot;) +
  ggtitle(label = &quot;Semi-log coordinate system&quot;)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/coord_semi_log-1.png" width="672" /></p>
<p>Or could even be drawn using <a href="https://en.wikipedia.org/wiki/Polar_coordinate_system"><strong>polar coordinates</strong></a>:</p>
<pre class="r"><code>p +
  coord_polar() +
  ggtitle(label = &quot;Polar coordinate system&quot;)</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/coord_polar-1.png" width="672" /></p>
</div>
<div id="faceting" class="section level2 tabset tabset-pills">
<h2>Faceting</h2>
<p><strong>Faceting</strong> can be used to split the data up into subsets of the entire dataset. This is a powerful tool when investigating whether patterns are the same or different across conditions, and allows the subsets to be visualized on the same plot (known as <strong>conditioned</strong> or <strong>trellis</strong> plots). The faceting specification describes which variables should be used to split up the data, and how they should be arranged.</p>
<pre class="r"><code>ggplot(data = penguins, 
       mapping = aes(x = bill_length_mm, 
                     y = body_mass_g)) +
  geom_point() +
  facet_wrap(~ island)</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/facet-1-1.png" width="672" /></p>
<pre class="r"><code>ggplot(data = penguins, mapping = aes(x = bill_length_mm, y = body_mass_g, color = sex)) +
  geom_point() +
  facet_grid(species ~ island, scales = &quot;free_y&quot;)</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/facet-2-1.png" width="672" /></p>
<pre class="r"><code># Ria&#39;s explanation: This code did not work becasue....</code></pre>
</div>
<div id="defaults" class="section level2">
<h2>Defaults</h2>
<p>Rather than explicitly declaring each component of a layered graphic (which will use more code and introduces opportunities for errors), we can establish intelligent defaults for specific geoms and scales. For instance, whenever we want to use a bar geom, we can default to using a stat that counts the number of observations in each group of our variable in the <span class="math inline">\(x\)</span> position.</p>
<p>Consider the following scenario: you wish to generate a scatterplot visualizing the relationship between penguins’ bill_length and their body_mass. With no defaults, the code to generate this graph is:</p>
<pre class="r"><code>ggplot() +
  layer(
    data = penguins, 
    mapping = aes(x = bill_length_mm, 
                  y = body_mass_g),
    geom = &quot;point&quot;, 
    stat = &quot;identity&quot;, 
    position = &quot;identity&quot;
  ) +
  scale_x_continuous() +
  scale_y_continuous() +
  coord_cartesian()</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/default-1.png" width="672" /></p>
<p>The above code:</p>
<ul>
<li><p>Creates a new plot object (<code>ggplot</code>)</p></li>
<li><p>Adds a layer (<code>layer</code>)</p>
<ul>
<li>Specifies the data (<code>penguins</code>)</li>
<li>Maps engine bill length to the <span class="math inline">\(x\)</span> position and body mass to the <span class="math inline">\(y\)</span> position (<code>mapping</code>)</li>
<li>Uses the point geometric transformation (<code>geom = "point"</code>)</li>
<li>Implements an identity transformation and position (<code>stat = "identity"</code> and <code>position = "identity"</code>)</li>
</ul></li>
<li><p>Establishes two continuous position scales (<code>scale_x_continuous</code> and <code>scale_y_continuous</code>)</p></li>
<li><p>Declares a cartesian coordinate system (<code>coord_cartesian</code>)</p></li>
</ul>
<p>How can we simplify this using intelligent defaults?</p>
<ol style="list-style-type: decimal">
<li><p>We only need to specify one geom and stat, since each geom has a default stat.</p></li>
<li><p>Cartesian coordinate systems are most commonly used, so it should be the default.</p></li>
<li><p>Default scales can be added based on the aesthetic and type of variables.</p>
<ul>
<li>Continuous values are transformed with a linear scaling.</li>
<li>Discrete values are mapped to integers.</li>
<li>Scales for aesthetics such as color, fill, and size can also be intelligently defaulted.</li>
</ul></li>
</ol>
<p>Using these defaults, we can rewrite the above code as:</p>
<pre class="r"><code>ggplot() +
  geom_point(data = penguins, 
             mapping = aes(x = bill_length_mm, 
                           y = body_mass_g))</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/default2-1.png" width="672" /></p>
<p>This generates the exact same plot, but uses fewer lines of code. Because multiple layers can use the same components (data, mapping, etc.), we can also specify that information in the <code>ggplot()</code> function rather than in the <code>layer()</code> function:</p>
<pre class="r"><code>ggplot(data = penguins, 
       mapping = aes(x = bill_length_mm, 
                     y = body_mass_g)) +
  geom_point()</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/default3-1.png" width="672" /></p>
<p>And as we will learn, function arguments in R use specific ordering, so we can omit the explicit call to <code>data</code> and <code>mapping</code>:</p>
<pre class="r"><code>ggplot(penguins, aes(bill_length_mm, body_mass_g)) +
  geom_point()</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values (geom_point).</code></pre>
<p><img src="/labs/07-Grammar-of-Graphics_files/figure-html/default4-1.png" width="672" /></p>
</div>
</div>
