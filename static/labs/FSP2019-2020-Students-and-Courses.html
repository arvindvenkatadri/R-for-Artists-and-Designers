---
title: "FSP2019-2020 Students and Courses"
author: "Arvind Venkatadri"
date: "29/02/2020"
output:
  html_document: default
  pdf_document: default
  word_document: default
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<div id="plotting-alluvial-plots-of-student-movement-across-fsp-courses" class="section level2">
<h2>Plotting Alluvial Plots of Student movement across FSP courses</h2>
<ol style="list-style-type: decimal">
<li>Let’s read Kumar’s Master File - Arvind.xlsx.<br />
</li>
<li>We will clean it up if needed.<br />
</li>
<li>Pivot it so that it is ready for Alluvial Plots</li>
</ol>
<p>In the following I do not show the R code that runs, just the plots. I am sure you understand why ;-D</p>
<p>For now, we will <em>not</em> need:</p>
<ul>
<li>Faculty Names<br />
</li>
<li>GSK course allocations<br />
</li>
<li>GS course allocations</li>
</ul>
<p>If this info is needed, we can retain it. The Alluvial Plots will then have to be plotted with care, since they will become cluttered. (Data can also be pivoted differently, Arvind.)</p>
<pre class="r"><code>data &lt;- data %&gt;% 
  mutate(Major = Course) %&gt;% 
  select(Name, Major, everything(), -contains(&quot;Faculty&quot;), -c(&quot;GSKS1&quot;, &quot;WKSS1&quot;, &quot;GSKS2&quot;, &quot;WKSS2&quot;, &quot;GSS2&quot;, &quot;Course&quot;))
glimpse(data)</code></pre>
<pre><code>## Rows: 323
## Columns: 6
## $ Name   &lt;chr&gt; &quot;Aabha Chhajer&quot;, &quot;Aaditya Nair&quot;, &quot;Aadya Naik&quot;, &quot;Aakanksha Ujjwa~
## $ Major  &lt;chr&gt; &quot;Film&quot;, &quot;CAP&quot;, &quot;VCSB&quot;, &quot;VCSB&quot;, &quot;IADP&quot;, &quot;HCD&quot;, &quot;IADP&quot;, &quot;PSD&quot;, &quot;V~
## $ CES1C1 &lt;chr&gt; &quot;O &amp; C&quot;, &quot;F &amp; S&quot;, &quot;S &amp; P&quot;, &quot;S &amp; P&quot;, &quot;F &amp; S&quot;, &quot;O &amp; C&quot;, &quot;F &amp; S&quot;, ~
## $ CES1C2 &lt;chr&gt; &quot;S &amp; P&quot;, &quot;C &amp; P&quot;, &quot;F &amp; S&quot;, &quot;F &amp; S&quot;, &quot;C &amp; P&quot;, &quot;S &amp; P&quot;, &quot;C &amp; P&quot;, ~
## $ CES2C1 &lt;chr&gt; &quot;F &amp; S&quot;, &quot;P &amp; I&quot;, &quot;O &amp; C&quot;, &quot;B &amp; C&quot;, &quot;B &amp; C&quot;, &quot;F &amp; S&quot;, &quot;P &amp; I&quot;, ~
## $ CES2C2 &lt;chr&gt; &quot;P &amp; I&quot;, &quot;O &amp; C&quot;, &quot;B &amp; C&quot;, &quot;O &amp; C&quot;, &quot;O &amp; C&quot;, &quot;P &amp; I&quot;, &quot;B &amp; C&quot;, ~</code></pre>
<pre class="r"><code>is_alluvia_form(data)</code></pre>
<pre><code>## Missing alluvia for some stratum combinations.</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code># It is possible to plot this wide form data too, by declaring any number of axis
ggplot(data = data,
       aes(axis1 = CES1C1, axis2 = CES1C2, axis3 = CES2C1, axis4 = CES2C2)) +
  geom_flow(stat = &quot;alluvium&quot;,aes(fill = Major)) +
  geom_stratum() +
  geom_label(stat = &quot;stratum&quot;, infer.label = TRUE) + 
  theme(legend.position = &quot;bottom&quot;) + 
  ggtitle(&quot;Student Curricula across several Cycles&quot;)</code></pre>
<pre><code>## Warning in to_lodes_form(data = data, axes = axis_ind, discern =
## params$discern): Some strata appear at multiple axes.

## Warning in to_lodes_form(data = data, axes = axis_ind, discern =
## params$discern): Some strata appear at multiple axes.

## Warning in to_lodes_form(data = data, axes = axis_ind, discern =
## params$discern): Some strata appear at multiple axes.</code></pre>
<pre><code>## Warning: The parameter `infer.label` is deprecated.
## Use `aes(label = after_stat(stratum))`.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/Cleanup%20Data-1.png" width="672" /></p>
<p>Now to rearrange/pivot the data so that it is ready for alluvial plotting: we have columns as follows:</p>
<ol style="list-style-type: decimal">
<li>Name ( of the Student )<br />
</li>
<li>Major (BSSD, CAP, CAC, DMA, etc….)<br />
</li>
<li>cycle ( S1C2, S1C2 etc…)<br />
</li>
<li>class ( which CE?)</li>
</ol>
<pre class="r"><code>data_long &lt;- data %&gt;%
    pivot_longer(., cols = c(&quot;CES1C1&quot;, &quot;CES1C2&quot;, &quot;CES2C1&quot;, &quot;CES2C2&quot;) , names_to = &quot;cycle&quot;, values_to = &quot;class&quot;)
data_long &lt;- data_long %&gt;% 
  filter(class %in% c(&quot;C &amp; P&quot;, &quot;P &amp; I&quot;,&quot;F &amp; S&quot;, &quot;S &amp; P&quot;, &quot;O &amp; C&quot;, &quot;B &amp; C&quot;)) # knocking off empties and &quot;Drop- Blank&quot;) 
unique(data_long$class)</code></pre>
<pre><code>## [1] &quot;O &amp; C&quot; &quot;S &amp; P&quot; &quot;F &amp; S&quot; &quot;P &amp; I&quot; &quot;C &amp; P&quot; &quot;B &amp; C&quot;</code></pre>
<pre class="r"><code>unique(data_long$cycle)</code></pre>
<pre><code>## [1] &quot;CES1C1&quot; &quot;CES1C2&quot; &quot;CES2C1&quot; &quot;CES2C2&quot;</code></pre>
<pre class="r"><code>glimpse(data_long)</code></pre>
<pre><code>## Rows: 1,280
## Columns: 4
## $ Name  &lt;chr&gt; &quot;Aabha Chhajer&quot;, &quot;Aabha Chhajer&quot;, &quot;Aabha Chhajer&quot;, &quot;Aabha Chhaje~
## $ Major &lt;chr&gt; &quot;Film&quot;, &quot;Film&quot;, &quot;Film&quot;, &quot;Film&quot;, &quot;CAP&quot;, &quot;CAP&quot;, &quot;CAP&quot;, &quot;CAP&quot;, &quot;VCS~
## $ cycle &lt;chr&gt; &quot;CES1C1&quot;, &quot;CES1C2&quot;, &quot;CES2C1&quot;, &quot;CES2C2&quot;, &quot;CES1C1&quot;, &quot;CES1C2&quot;, &quot;CES~
## $ class &lt;chr&gt; &quot;O &amp; C&quot;, &quot;S &amp; P&quot;, &quot;F &amp; S&quot;, &quot;P &amp; I&quot;, &quot;F &amp; S&quot;, &quot;C &amp; P&quot;, &quot;P &amp; I&quot;, &quot;~</code></pre>
<pre class="r"><code>is_alluvia_form(data_long)</code></pre>
<pre><code>## Missing alluvia for some stratum combinations.</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>All done. Let’s plot the alluvial graph.</p>
<pre><code>## Warning: The parameter `infer.label` is deprecated.
## Use `aes(label = after_stat(stratum))`.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>This is looking very crowded. We can see flows of students of different Majors across course, but can’t make out fine structure, because of too many Majors/colours.</p>
</div>
<div id="major-wise-plotting-of-ce-courses" class="section level2">
<h2>Major wise plotting of CE courses</h2>
<p>So we will need to plot subfraphs, based on some groups of Majors</p>
<p>Group 1: CAP/DMA/Film<br />
Group 2: CAC/CE/CW<br />
Group 3: BSSD/HCD/IADP<br />
Group 4: IAIDP/VCSB/PSD</p>
<div id="cap-dma-and-film-students" class="section level3">
<h3>CAP, DMA and Film Students</h3>
<pre><code>## Warning: The parameter `infer.label` is deprecated.
## Use `aes(label = after_stat(stratum))`.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/CAP-1.png" width="672" /></p>
<pre><code>## Warning: The parameter `infer.label` is deprecated.
## Use `aes(label = after_stat(stratum))`.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/CAP-2.png" width="672" /></p>
<p>So looks like</p>
<ol style="list-style-type: decimal">
<li>Very few Film have done Body and Context. Whoa !!!</li>
<li>CAP and DMA kids have had a good mix of courses</li>
</ol>
</div>
<div id="cac-ce-and-cw-students" class="section level3">
<h3>CAC CE and CW students</h3>
<pre><code>## Warning: The parameter `infer.label` is deprecated.
## Use `aes(label = after_stat(stratum))`.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/CAC-1.png" width="672" /></p>
<pre><code>## Warning: The parameter `infer.label` is deprecated.
## Use `aes(label = after_stat(stratum))`.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/CAC-2.png" width="672" />
So looks like</p>
<ol style="list-style-type: decimal">
<li>Very few of the CE kids have done Space and Place.</li>
<li>Very few CW kids have done Play and Invent</li>
<li>CAC kids have had a good mix of courses</li>
</ol>
</div>
<div id="iadp-bssd-hcd-students" class="section level3">
<h3>IADP, BSSD, HCD students</h3>
<pre><code>## Warning: The parameter `infer.label` is deprecated.
## Use `aes(label = after_stat(stratum))`.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/IADP,BSSD,HCD-1.png" width="672" /></p>
<pre><code>## Warning: The parameter `infer.label` is deprecated.
## Use `aes(label = after_stat(stratum))`.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/IADP,BSSD,HCD-2.png" width="672" />
So looks like</p>
<ol style="list-style-type: decimal">
<li>HCD kids have done Space and Place but have not done Communities and Practices. Very few have done Body and Context.</li>
<li>IADP kids have had a good mix of courses</li>
<li>1 IADP student is repeating Body and Context in S2C2.</li>
</ol>
</div>
<div id="iaidpvcsbpsd-students" class="section level3">
<h3>IAIDP,VCSB,PSD students</h3>
<pre><code>## Warning: The parameter `infer.label` is deprecated.
## Use `aes(label = after_stat(stratum))`.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/IAIDP,%20VCSB,PSD-1.png" width="672" /></p>
<pre><code>## Warning: The parameter `infer.label` is deprecated.
## Use `aes(label = after_stat(stratum))`.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/IAIDP,%20VCSB,PSD-2.png" width="672" />
So looks like</p>
<ol style="list-style-type: decimal">
<li>Very few IAIDP kids have done Space and Place</li>
<li>VCSB and PSD kids have had a good mix of courses</li>
</ol>
</div>
</div>
<div id="checking-for-faculty-repeat" class="section level2">
<h2>Checking for Faculty repeat !!</h2>
<p>Let’s try plotting the Faculty and see if they repeat for any students:</p>
<pre class="r"><code>data &lt;- readxl::read_xlsx(path = &quot;./data/Master file - Arvind.xlsx&quot;,range = &quot;C1:W324&quot;,trim_ws = TRUE)</code></pre>
<pre><code>## New names:
## * Faculty -&gt; Faculty...4
## * Faculty -&gt; Faculty...6
## * Faculty -&gt; Faculty...9
## * Faculty -&gt; Faculty...11</code></pre>
<pre class="r"><code>glimpse(data)</code></pre>
<pre><code>## Rows: 323
## Columns: 21
## $ Name            &lt;chr&gt; &quot;Aabha Chhajer&quot;, &quot;Aaditya Nair&quot;, &quot;Aadya Naik&quot;, &quot;Aakank~
## $ Course          &lt;chr&gt; &quot;Film&quot;, &quot;CAP&quot;, &quot;VCSB&quot;, &quot;VCSB&quot;, &quot;IADP&quot;, &quot;HCD&quot;, &quot;IADP&quot;, ~
## $ CES1C1          &lt;chr&gt; &quot;O &amp; C&quot;, &quot;F &amp; S&quot;, &quot;S &amp; P&quot;, &quot;S &amp; P&quot;, &quot;F &amp; S&quot;, &quot;O &amp; C&quot;, ~
## $ Faculty...4     &lt;chr&gt; &quot;Ajai&quot;, &quot;Abhishek&quot;, &quot;Arul&quot;, &quot;Sudebi&quot;, &quot;Ashwathi&quot;, &quot;Lav~
## $ GSKS1           &lt;chr&gt; &quot;MM&quot;, &quot;DM&quot;, &quot;FM&quot;, &quot;FM&quot;, &quot;DM&quot;, &quot;MM&quot;, &quot;DM&quot;, &quot;FM&quot;, &quot;FM&quot;, ~
## $ Faculty...6     &lt;chr&gt; &quot;Hiranmayi&quot;, &quot;Sujatha&quot;, &quot;Babita&quot;, &quot;Kamya&quot;, &quot;Abhishek&quot;,~
## $ `GS Faculty`    &lt;chr&gt; &quot;Manjula&quot;, &quot;Manjusha&quot;, &quot;Vishwesh&quot;, &quot;Dipankar&quot;, &quot;Keshav~
## $ WKSS1           &lt;chr&gt; &quot;FM&quot;, &quot;MM&quot;, &quot;DM&quot;, &quot;DM&quot;, &quot;MM&quot;, &quot;FM&quot;, &quot;MM&quot;, &quot;DM&quot;, &quot;DM&quot;, ~
## $ Faculty...9     &lt;chr&gt; &quot;Kumar K J&quot;, &quot;Subhashree&quot;, &quot;Syed Gohar&quot;, &quot;Venkat Chila~
## $ CES1C2          &lt;chr&gt; &quot;S &amp; P&quot;, &quot;C &amp; P&quot;, &quot;F &amp; S&quot;, &quot;F &amp; S&quot;, &quot;C &amp; P&quot;, &quot;S &amp; P&quot;, ~
## $ Faculty...11    &lt;chr&gt; &quot;Arnab&quot;, &quot;Aastha&quot;, &quot;Hiranmayi&quot;, &quot;Mahesh&quot;, &quot;Sudebi&quot;, &quot;S~
## $ `EE Faculty`    &lt;chr&gt; &quot;Ankita, Gururaj&quot;, &quot;Chinar, Karan&quot;, &quot;Pradnya, Kumar&quot;, ~
## $ GSKS2           &lt;chr&gt; &quot;DTT&quot;, &quot;DeTT&quot;, &quot;VTT&quot;, &quot;VTT&quot;, &quot;DeTT&quot;, &quot;DTT&quot;, &quot;VTT&quot;, &quot;VT~
## $ `GSK Faculty`   &lt;chr&gt; &quot;Arul&quot;, &quot;Narendra&quot;, &quot;RAMESH&quot;, &quot;Sonia&quot;, &quot;Kumar&quot;, &quot;Arul&quot;~
## $ CES2C1          &lt;chr&gt; &quot;F &amp; S&quot;, &quot;P &amp; I&quot;, &quot;O &amp; C&quot;, &quot;B &amp; C&quot;, &quot;B &amp; C&quot;, &quot;F &amp; S&quot;, ~
## $ `CE FACULTY`    &lt;chr&gt; &quot;Geethanjali&quot;, &quot;Babita&quot;, &quot;Ajai&quot;, &quot;Arul&quot;, &quot;Arul&quot;, &quot;Geet~
## $ GSS2            &lt;chr&gt; &quot;Ravi N&quot;, &quot;PREETA&quot;, &quot;Carl&quot;, &quot;Manjusha&quot;, &quot;Aileen&quot;, &quot;Asm~
## $ CES2C2          &lt;chr&gt; &quot;P &amp; I&quot;, &quot;O &amp; C&quot;, &quot;B &amp; C&quot;, &quot;O &amp; C&quot;, &quot;O &amp; C&quot;, &quot;P &amp; I&quot;, ~
## $ `CE C2 faculty` &lt;chr&gt; &quot;Babita&quot;, &quot;Ajai&quot;, &quot;Narendra&quot;, &quot;John Ganta&quot;, &quot;Ajai&quot;, &quot;B~
## $ WKSS2           &lt;chr&gt; &quot;DeTT&quot;, &quot;VTT&quot;, &quot;SCTT&quot;, &quot;DeTT&quot;, &quot;VTT&quot;, &quot;DeTT&quot;, &quot;DeTT&quot;, ~
## $ `WKS Faculty`   &lt;chr&gt; &quot;Rachel Immanuel&quot;, &quot;Reji Vaheed&quot;, &quot;Homa Sarabi&quot;, &quot;Rach~</code></pre>
<pre class="r"><code>data_faculty &lt;- data %&gt;% 
  mutate(Major = Course) %&gt;% 
  select(Name, Major, contains(c(&quot;Faculty&quot;, &quot;FACULTY&quot;)))
data_faculty &lt;- data_faculty %&gt;% 
  mutate(T1 = Faculty...4, T2 = Faculty...6, T3 = Faculty...9, T4 = Faculty...11, T5 = `CE FACULTY`, T6 = `CE C2 faculty`) %&gt;% 
  select(Name, Major, starts_with(&quot;T&quot;))
glimpse(data_faculty)</code></pre>
<pre><code>## Rows: 323
## Columns: 8
## $ Name  &lt;chr&gt; &quot;Aabha Chhajer&quot;, &quot;Aaditya Nair&quot;, &quot;Aadya Naik&quot;, &quot;Aakanksha Ujjwal~
## $ Major &lt;chr&gt; &quot;Film&quot;, &quot;CAP&quot;, &quot;VCSB&quot;, &quot;VCSB&quot;, &quot;IADP&quot;, &quot;HCD&quot;, &quot;IADP&quot;, &quot;PSD&quot;, &quot;VC~
## $ T1    &lt;chr&gt; &quot;Ajai&quot;, &quot;Abhishek&quot;, &quot;Arul&quot;, &quot;Sudebi&quot;, &quot;Ashwathi&quot;, &quot;Lavanya&quot;, &quot;Ma~
## $ T2    &lt;chr&gt; &quot;Hiranmayi&quot;, &quot;Sujatha&quot;, &quot;Babita&quot;, &quot;Kamya&quot;, &quot;Abhishek&quot;, &quot;Arnab&quot;, ~
## $ T3    &lt;chr&gt; &quot;Kumar K J&quot;, &quot;Subhashree&quot;, &quot;Syed Gohar&quot;, &quot;Venkat Chilakuri&quot;, &quot;Hi~
## $ T4    &lt;chr&gt; &quot;Arnab&quot;, &quot;Aastha&quot;, &quot;Hiranmayi&quot;, &quot;Mahesh&quot;, &quot;Sudebi&quot;, &quot;Sudipto&quot;, &quot;~
## $ T5    &lt;chr&gt; &quot;Geethanjali&quot;, &quot;Babita&quot;, &quot;Ajai&quot;, &quot;Arul&quot;, &quot;Arul&quot;, &quot;Geethanjali&quot;, ~
## $ T6    &lt;chr&gt; &quot;Babita&quot;, &quot;Ajai&quot;, &quot;Narendra&quot;, &quot;John Ganta&quot;, &quot;Ajai&quot;, &quot;Babita&quot;, &quot;V~</code></pre>
<pre class="r"><code>is_alluvia_form(data_faculty)</code></pre>
<pre><code>## Missing alluvia for some stratum combinations.</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>What we need is to to summarize the data to see if there are any students who meet the same faculty member more than once.</p>
<p>Let’s check this: ( I need to use “purrr” here, absolutely, to avoid writing code to check for duplication of each faculty member)</p>
<pre class="r"><code>data_temp &lt;- data_faculty %&gt;% 
mutate(D.AV = rowSums(select(., starts_with(&quot;T&quot;)) == &quot;Arvind&quot;)) 
data_temp$D.AV</code></pre>
<pre><code>##   [1]  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  0  1  0  0  1  0  1  1  1  0
##  [26]  0  0  0  0  0  0  0  1  0  1  0  0  1  1  0  0  1  1  0  0  0  0  0  0  0
##  [51]  0  0  0  0  0  0  0  1 NA  0  0  0  0  1  0  0  0  1  0  0  0  1  1  0  0
##  [76]  1  0  0  0 NA  0  0  0  0  1  0  1  0  0  0  0  1  0  0  0  1  0  1  0  0
## [101]  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0
## [126]  0  0  0  0  0  0  0  1  0  1  1  1  1  0  0  0  0  0  1  1  0  0  1  0  0
## [151]  1  0  0  0  0  0  0  0  0  0  1 NA  0  1  0  1  0  0  0  0  0  1  0  1  0
## [176]  0  0  0  1  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  1  1
## [201]  0  0  0  0  0  0  1  0  0  1  0  0  1  0  0  0  0  0  1  0  0  0  0  1  1
## [226]  0  0  1  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  0  0
## [251]  0  1  0  0  0  0  1  0  0  1  0  0  0  1 NA  0  0  1  0 NA  0  0  0  0  0
## [276]  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  1  0  1  0  0
## [301]  0  0  0  1  0  0  0  1  0  1  0  0  1  0  1  0  0  0  0  1  0  0  1</code></pre>
<pre class="r"><code>any(data_temp$D.AV &gt; 1, na.rm = TRUE)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="r"><code>if(any(data_temp$D.AV &gt; 1,na.rm = TRUE)) cat(&quot;Arvind has repeats!&quot;)</code></pre>
</div>
<div id="titanic-dataset" class="section level2">
<h2>Titanic Dataset</h2>
<pre class="r"><code>titanic &lt;- as.data.frame(Titanic)
glimpse(titanic)</code></pre>
<pre><code>## Rows: 32
## Columns: 5
## $ Class    &lt;fct&gt; 1st, 2nd, 3rd, Crew, 1st, 2nd, 3rd, Crew, 1st, 2nd, 3rd, Crew~
## $ Sex      &lt;fct&gt; Male, Male, Male, Male, Female, Female, Female, Female, Male,~
## $ Age      &lt;fct&gt; Child, Child, Child, Child, Child, Child, Child, Child, Adult~
## $ Survived &lt;fct&gt; No, No, No, No, No, No, No, No, No, No, No, No, No, No, No, N~
## $ Freq     &lt;dbl&gt; 0, 0, 35, 0, 0, 0, 17, 0, 118, 154, 387, 670, 4, 13, 89, 3, 5~</code></pre>
<pre class="r"><code>ggplot(titanic,
       aes(y = Freq, # No of people defined by each category
           axis1 = Class, axis2 = Sex, axis3 = Age, axis4 = Survived)) + # Categories
  geom_alluvium(aes(fill = Sex)) +
  geom_stratum(width = 1/3, reverse = FALSE) +
  geom_text(aes(label = after_stat(stratum)), stat = &quot;stratum&quot;, reverse = FALSE) +
  scale_x_continuous(breaks = 1:4, labels = c(&quot;Class&quot;,&quot;Sex&quot;, &quot;Age&quot;, &quot;Survived&quot;)) +
  # coord_flip() +
  ggtitle(&quot;Titanic survival by class and sex&quot;)</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/Titanic%20Alluvial%20Plot-1.png" width="672" /></p>
<pre class="r"><code>library(ggnewscale)
Titanic %&gt;% 
  as_tibble() %&gt;% 
  ggplot(.,
       aes(
         # Y axis is count of people, i.e. the &quot;n&quot; variable
         y = n,
           
         # Define the &quot;axes&quot;
         axis1 = Class, axis2 = Age, axis3 = Survived)) +
  
  # We want axes to be broken up into strata
  geom_stratum(aes(fill = after_stat(stratum)),alpha = 0.6) +
  scale_fill_brewer(palette = &quot;Spectral&quot;) +
  # Try either Alluvia that go right through
  #geom_alluvium(aes(fill = Sex)) +
  new_scale_fill() +
  # or try Flows that connect between Strata
  geom_flow(aes(fill = Sex), colour = &quot;black&quot;) +
    scale_fill_brewer(aesthetics = c(&quot;fill&quot;), palette = &quot;Paired&quot;) +
  scale_x_discrete(limits = c(&quot;Class&quot;, &quot;Age&quot;, &quot;Survived&quot;)) +
  geom_text(stat = &quot;stratum&quot;, aes(label = after_stat(stratum))) +
  ggtitle(&quot;Alluvial plot of Titanic passenger demographic data&quot;)</code></pre>
<pre><code>## Warning: The `.dots` argument of `group_by()` is deprecated as of dplyr 1.0.0.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/help-example-1.png" width="672" /></p>
<pre class="r"><code>mtcars2 %&gt;% 
  ggplot(., aes(
    axis1 = cyl, axis2 = gear, axis3=am, axis4 = carb)) +
  geom_stratum(aes(fill = after_stat(stratum))) +
  geom_flow(aes(fill = am),curve_type = &quot;quintic&quot;,colour = &quot;black&quot;) +
  scale_color_brewer(aesthetics = c(&quot;fill&quot;, &quot;colour&quot;), palette = &quot;Paired&quot;) +
  geom_text(stat = &quot;stratum&quot;, aes(label = after_stat(stratum)),) +
  scale_x_discrete(limits = c(&quot;Cylinders&quot;, &quot;Gears&quot;,&quot;Transmission&quot;, &quot;Carburettors&quot;))</code></pre>
<pre><code>## Warning in to_lodes_form(data = data, axes = axis_ind, discern =
## params$discern): Some strata appear at multiple axes.

## Warning in to_lodes_form(data = data, axes = axis_ind, discern =
## params$discern): Some strata appear at multiple axes.

## Warning in to_lodes_form(data = data, axes = axis_ind, discern =
## params$discern): Some strata appear at multiple axes.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>data_faculty %&gt;%
  filter(Major == &quot;DMA&quot;) %&gt;%
ggplot(.,
       aes(axis1 = T1, axis2 = T2, axis3 = T3, axis4 = T4,axis5 = T5, axis6 = T6)) +
  geom_flow(stat = &quot;alluvium&quot;,aes(fill = Major)) +
  geom_stratum() +
  geom_label(stat = &quot;stratum&quot;, infer.label = TRUE) + 
  theme(legend.position = &quot;bottom&quot;) + 
  ggtitle(&quot;Student Curricula across several Cycles&quot;)</code></pre>
<pre><code>## Warning in to_lodes_form(data = data, axes = axis_ind, discern =
## params$discern): Some strata appear at multiple axes.

## Warning in to_lodes_form(data = data, axes = axis_ind, discern =
## params$discern): Some strata appear at multiple axes.

## Warning in to_lodes_form(data = data, axes = axis_ind, discern =
## params$discern): Some strata appear at multiple axes.</code></pre>
<pre><code>## Warning: The parameter `infer.label` is deprecated.
## Use `aes(label = after_stat(stratum))`.</code></pre>
<p><img src="/labs/FSP2019-2020-Students-and-Courses_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
